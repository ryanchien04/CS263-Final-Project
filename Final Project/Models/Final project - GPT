{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"gpuType":"T4"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"c72a5cebdf9748c2b2301a4e44e6322c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7a3915b2509a4a539da3a683a4300f28","IPY_MODEL_efc50b5a249a4fe4a91745b239567e19","IPY_MODEL_a1efde65ff9943d3a85696a801901d93"],"layout":"IPY_MODEL_ac119308fb5344de9836aefd8d09ac69"}},"7a3915b2509a4a539da3a683a4300f28":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_792998aa92ec40a8907ce1e4e0343a09","placeholder":"​","style":"IPY_MODEL_271b24b6ee7b469a9234f4f9bd8058da","value":"Downloading (…)lve/main/config.json: 100%"}},"efc50b5a249a4fe4a91745b239567e19":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_fdcd9687aa4d463d98adf2488d40adb1","max":762,"min":0,"orientation":"horizontal","style":"IPY_MODEL_61d5a83bc952407ebbd59c46fa5b9ce2","value":762}},"a1efde65ff9943d3a85696a801901d93":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ec86c7650c214bb98f741c73776e137e","placeholder":"​","style":"IPY_MODEL_cef6e2a73cf046409cc58f943b188018","value":" 762/762 [00:00&lt;00:00, 31.8kB/s]"}},"ac119308fb5344de9836aefd8d09ac69":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"792998aa92ec40a8907ce1e4e0343a09":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"271b24b6ee7b469a9234f4f9bd8058da":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fdcd9687aa4d463d98adf2488d40adb1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"61d5a83bc952407ebbd59c46fa5b9ce2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ec86c7650c214bb98f741c73776e137e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cef6e2a73cf046409cc58f943b188018":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8acc69104267434cab72025ee72ca4cb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_87f997c1b8c84f7e9598de06c99f8f14","IPY_MODEL_203f2f3c44ef4998a75f13072937bddb","IPY_MODEL_dfa468b9b6384ed184651c506a2392bc"],"layout":"IPY_MODEL_7b085a657c5342b184f5109ebe2bb10a"}},"87f997c1b8c84f7e9598de06c99f8f14":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_52825a7f954f47be82cb7d3fe6fb13b8","placeholder":"​","style":"IPY_MODEL_e58b2098c0a34b8198374487dafe54be","value":"Downloading (…)olve/main/vocab.json: 100%"}},"203f2f3c44ef4998a75f13072937bddb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bc3c579c8b7249618138c3111e4f31b2","max":1042301,"min":0,"orientation":"horizontal","style":"IPY_MODEL_be694847cd694569bc808e2b94d64327","value":1042301}},"dfa468b9b6384ed184651c506a2392bc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_77ac2ca2fc4e4007a396e415f8afed25","placeholder":"​","style":"IPY_MODEL_a1506a35a693495bbe9f1fa92054c306","value":" 1.04M/1.04M [00:00&lt;00:00, 10.3MB/s]"}},"7b085a657c5342b184f5109ebe2bb10a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"52825a7f954f47be82cb7d3fe6fb13b8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e58b2098c0a34b8198374487dafe54be":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bc3c579c8b7249618138c3111e4f31b2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"be694847cd694569bc808e2b94d64327":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"77ac2ca2fc4e4007a396e415f8afed25":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a1506a35a693495bbe9f1fa92054c306":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7e7bce32b6324acea4de9a02ea9630f0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_87f0c820d7ff4b858e549327e86914cb","IPY_MODEL_26317ef15b2846d48411faee8eb8e527","IPY_MODEL_9269fc58a50442b4bf3700e5ecd9498f"],"layout":"IPY_MODEL_e52032851d324ae1ab55088e977193f2"}},"87f0c820d7ff4b858e549327e86914cb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5273b6571f1e47e49289a8b218d4b685","placeholder":"​","style":"IPY_MODEL_926d2038672d47418e311e628d92a0de","value":"Downloading (…)olve/main/merges.txt: 100%"}},"26317ef15b2846d48411faee8eb8e527":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_828267592b1e46deabaa4cf6cbabd8c3","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_33e12916acd74f62b27c15c4b93fadf3","value":456318}},"9269fc58a50442b4bf3700e5ecd9498f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bf2c4067d43f4d42b71686856974584d","placeholder":"​","style":"IPY_MODEL_23e1e74056cf4fddac32aab962d154ee","value":" 456k/456k [00:00&lt;00:00, 8.68MB/s]"}},"e52032851d324ae1ab55088e977193f2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5273b6571f1e47e49289a8b218d4b685":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"926d2038672d47418e311e628d92a0de":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"828267592b1e46deabaa4cf6cbabd8c3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"33e12916acd74f62b27c15c4b93fadf3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bf2c4067d43f4d42b71686856974584d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23e1e74056cf4fddac32aab962d154ee":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7b55cbef22844086860aee2d18598ca9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_beb0d9f3549a4b23aa1dacb4bd66f091","IPY_MODEL_35737c6c38954755a27bee7144053b7c","IPY_MODEL_1d3f6b14c23c4fa692f22b188c7c4e12"],"layout":"IPY_MODEL_7abf973459914462892805ccc16add9c"}},"beb0d9f3549a4b23aa1dacb4bd66f091":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_eae6ae85cafe42359d18fb33d2473125","placeholder":"​","style":"IPY_MODEL_92ede28d6d8149899e214a5846c4590b","value":"Downloading (…)/main/tokenizer.json: 100%"}},"35737c6c38954755a27bee7144053b7c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_110a9b436c054251aed55e873a00928c","max":1355256,"min":0,"orientation":"horizontal","style":"IPY_MODEL_69d93ea5040c4c22a408d63cf6f19974","value":1355256}},"1d3f6b14c23c4fa692f22b188c7c4e12":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_733e6244f29046da869a4f92e73bc330","placeholder":"​","style":"IPY_MODEL_91fd3322529a4102b0c352256babc2d2","value":" 1.36M/1.36M [00:00&lt;00:00, 11.4MB/s]"}},"7abf973459914462892805ccc16add9c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eae6ae85cafe42359d18fb33d2473125":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"92ede28d6d8149899e214a5846c4590b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"110a9b436c054251aed55e873a00928c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"69d93ea5040c4c22a408d63cf6f19974":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"733e6244f29046da869a4f92e73bc330":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"91fd3322529a4102b0c352256babc2d2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dd58b224e6024d088290eb5a349ed79c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_08a9980ef5194638adc6a7ae686a575f","IPY_MODEL_514b377aaa4647f5b6ce2d0d269dd416","IPY_MODEL_44cecc4347814ae48c3fddfaafb479da"],"layout":"IPY_MODEL_14f9112e4dff465794d5bff682b5cdaf"}},"08a9980ef5194638adc6a7ae686a575f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0f52ce0728b44c088d8bf6fdf93194f9","placeholder":"​","style":"IPY_MODEL_3ae5066e933b42c88f9bd2d6ef95a203","value":"Downloading builder script: "}},"514b377aaa4647f5b6ce2d0d269dd416":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8c57bed9e9304ce0870bdce2d124fcb8","max":1652,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4acf84e0939849f4904615bc61e81887","value":1652}},"44cecc4347814ae48c3fddfaafb479da":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8f2bc6992fa346a3a83b3c1d67ffadd5","placeholder":"​","style":"IPY_MODEL_a6cfc700aa2641a4b77fa4e999925f58","value":" 4.21k/? [00:00&lt;00:00, 68.6kB/s]"}},"14f9112e4dff465794d5bff682b5cdaf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0f52ce0728b44c088d8bf6fdf93194f9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3ae5066e933b42c88f9bd2d6ef95a203":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8c57bed9e9304ce0870bdce2d124fcb8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4acf84e0939849f4904615bc61e81887":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8f2bc6992fa346a3a83b3c1d67ffadd5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a6cfc700aa2641a4b77fa4e999925f58":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b5f3c7c9173942d5a903b4956413d762":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_09ff3a5909004599bf1f02e41461c197","IPY_MODEL_5eacad84d7734957a16030eed9cdfd45","IPY_MODEL_e4664e50da4d447cad01a036151ec909"],"layout":"IPY_MODEL_61e39c1d87d74b149c550650b46fd1c3"}},"09ff3a5909004599bf1f02e41461c197":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_67f3468b88014e849d4cad134bc92a43","placeholder":"​","style":"IPY_MODEL_3622d9e880524e8e8a031122232abcca","value":"Downloading model.safetensors: 100%"}},"5eacad84d7734957a16030eed9cdfd45":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1ee811889edb48f2b51b61c563d582d7","max":352824413,"min":0,"orientation":"horizontal","style":"IPY_MODEL_de6ce2d0b7264e61acfb5a5eccc6a366","value":352824413}},"e4664e50da4d447cad01a036151ec909":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7e8e2be2cc254feda670b3357da0b950","placeholder":"​","style":"IPY_MODEL_a60c9b04a5d54d74a13e64d727690f07","value":" 353M/353M [00:09&lt;00:00, 43.8MB/s]"}},"61e39c1d87d74b149c550650b46fd1c3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"67f3468b88014e849d4cad134bc92a43":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3622d9e880524e8e8a031122232abcca":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1ee811889edb48f2b51b61c563d582d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"de6ce2d0b7264e61acfb5a5eccc6a366":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7e8e2be2cc254feda670b3357da0b950":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a60c9b04a5d54d74a13e64d727690f07":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sqnV1wnV_iHU","executionInfo":{"status":"ok","timestamp":1686369143982,"user_tz":420,"elapsed":19374,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"df8ea237-996e-4088-a2dc-62e794471088"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n","/content/drive/Shareddrives/CS263\n"]}],"source":["import os\n","from google.colab import drive\n","drive.mount('/content/drive')\n","%cd /content/drive/Shareddrives/CS263"]},{"cell_type":"code","source":["!pip install datasets\n","!pip install transformers[torch]"],"metadata":{"id":"O0hye2QojNR0","executionInfo":{"status":"ok","timestamp":1686369169353,"user_tz":420,"elapsed":25374,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"0246e10b-8352-4022-837a-f10224435eb0"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.12.0-py3-none-any.whl (474 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m474.6/474.6 kB\u001b[0m \u001b[31m10.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting dill<0.3.7,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m13.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m21.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.14-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m18.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Collecting aiohttp (from datasets)\n","  Downloading aiohttp-3.8.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m39.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting huggingface-hub<1.0.0,>=0.11.0 (from datasets)\n","  Downloading huggingface_hub-0.15.1-py3-none-any.whl (236 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m236.8/236.8 kB\u001b[0m \u001b[31m26.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Collecting responses<0.19 (from datasets)\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting multidict<7.0,>=4.5 (from aiohttp->datasets)\n","  Downloading multidict-6.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 kB\u001b[0m \u001b[31m11.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3 (from aiohttp->datasets)\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting yarl<2.0,>=1.0 (from aiohttp->datasets)\n","  Downloading yarl-1.9.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m29.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting frozenlist>=1.1.1 (from aiohttp->datasets)\n","  Downloading frozenlist-1.3.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m149.6/149.6 kB\u001b[0m \u001b[31m18.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiosignal>=1.1.2 (from aiohttp->datasets)\n","  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (3.12.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Installing collected packages: xxhash, multidict, frozenlist, dill, async-timeout, yarl, responses, multiprocess, huggingface-hub, aiosignal, aiohttp, datasets\n","Successfully installed aiohttp-3.8.4 aiosignal-1.3.1 async-timeout-4.0.2 datasets-2.12.0 dill-0.3.6 frozenlist-1.3.3 huggingface-hub-0.15.1 multidict-6.0.4 multiprocess-0.70.14 responses-0.18.0 xxhash-3.2.0 yarl-1.9.2\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers[torch]\n","  Downloading transformers-4.30.1-py3-none-any.whl (7.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m53.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (3.12.0)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.14.1 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (0.15.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers[torch])\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m96.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers[torch])\n","  Downloading safetensors-0.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m72.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (4.65.0)\n","Requirement already satisfied: torch!=1.12.0,>=1.9 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2.0.1+cu118)\n","Collecting accelerate>=0.20.2 (from transformers[torch])\n","  Downloading accelerate-0.20.3-py3-none-any.whl (227 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m227.6/227.6 kB\u001b[0m \u001b[31m26.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate>=0.20.2->transformers[torch]) (5.9.5)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers[torch]) (2023.4.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers[torch]) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch!=1.12.0,>=1.9->transformers[torch]) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch!=1.12.0,>=1.9->transformers[torch]) (16.0.5)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (3.4)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch!=1.12.0,>=1.9->transformers[torch]) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch!=1.12.0,>=1.9->transformers[torch]) (1.3.0)\n","Installing collected packages: tokenizers, safetensors, transformers, accelerate\n","Successfully installed accelerate-0.20.3 safetensors-0.3.1 tokenizers-0.13.3 transformers-4.30.1\n"]}]},{"cell_type":"code","source":["import csv\n","\n","label_dict = {'not sexist': 0, 'sexist': 1}\n","category_dict = {'1. threats, plans to harm and incitement': 0, '2. derogation': 1, '3. animosity': 2, '4. prejudiced discussions': 3, 'none': 4}\n","vector_dict = {\n","    '1.1 threats of harm': 0, \n","    '1.2 incitement and encouragement of harm': 1, \n","    '2.1 descriptive attacks': 2,\n","    '2.2 aggressive and emotive attacks': 3,\n","    '2.3 dehumanising attacks & overt sexual objectification': 4,\n","    '3.1 casual use of gendered slurs, profanities, and insults': 5,\n","    '3.2 immutable gender differences and gender stereotypes': 6,\n","    '3.3 backhanded gendered compliments': 7,\n","    '3.4 condescending explanations or unwelcome advice': 8,\n","    '4.1 supporting mistreatment of individual women': 9,\n","    '4.2 supporting systemic discrimination against women as a group': 10,\n","    'none': 0,\n","    }\n","\n","with open('edos_labelled_aggregated.csv') as file:\n","  data = list(csv.reader(file, quotechar='\"')) \n","  taskA_train = []\n","  taskA_dev = []\n","  taskA_test = []\n","  taskB_train = []\n","  taskB_dev = []\n","  taskB_test = []\n","  taskC_train = []\n","  taskC_dev = []\n","  taskC_test = []\n","  for i in range(len(data)):\n","    if i == 0:\n","      continue\n","    \n","    temp_dict = {\n","        'rewire_id': data[i][0], \n","        'text': data[i][1], \n","        'label_sexist': label_dict[data[i][2]], \n","        'label_category': category_dict[data[i][3]],\n","        'label_vector': vector_dict[data[i][4]],\n","        'split': data[i][5]\n","        }\n","\n","    if temp_dict['split'] == 'train':\n","      taskA_train.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_train.append(temp_dict)\n","        taskC_train.append(temp_dict)\n","    elif temp_dict['split'] == 'dev':\n","      taskA_dev.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_dev.append(temp_dict)\n","        taskC_dev.append(temp_dict)\n","    else:\n","      taskA_test.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_test.append(temp_dict)\n","        taskC_test.append(temp_dict)\n"],"metadata":{"id":"_AdDAamfAPhl","executionInfo":{"status":"ok","timestamp":1686369169871,"user_tz":420,"elapsed":525,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["print(len(taskA_train), len(taskA_dev), len(taskA_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4VzyUYtfA_6J","executionInfo":{"status":"ok","timestamp":1686369170035,"user_tz":420,"elapsed":165,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"52d1d930-416d-4943-ff01-afce554bcdff"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["14000 2000 4000\n"]}]},{"cell_type":"code","source":["print(len(taskB_train), len(taskB_dev), len(taskB_test))  "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Z17kv9oNFsbc","executionInfo":{"status":"ok","timestamp":1686369170035,"user_tz":420,"elapsed":3,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"20f258db-0de9-4128-9fef-689c62c4c2bb"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["3398 486 970\n"]}]},{"cell_type":"code","source":["print(len(taskC_train), len(taskC_dev), len(taskC_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ynYNkDf4FtBr","executionInfo":{"status":"ok","timestamp":1686369170035,"user_tz":420,"elapsed":2,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"61d8a3a4-4569-4e51-a0fb-a9c12a04de71"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["3398 486 970\n"]}]},{"cell_type":"code","source":["from sklearn.metrics import (accuracy_score, \n","                             auc,\n","                             confusion_matrix,\n","                              precision_score,\n","                              recall_score,\n","                              f1_score\n","                            )\n","\n","def get_acc(y_test, y_pred):\n","    acc = round(accuracy_score(y_test,y_pred), 5)\n","    precision = precision_score(y_test, y_pred, average='weighted')\n","    recall = recall_score(y_test, y_pred, average='weighted')\n","    f1score = f1_score(y_test, y_pred, average='weighted')\n","    print(f\"Accuracy: {acc}\")\n","    print(f\"precision: {precision}\")\n","    print(f\"recall: {recall}\")\n","    print(f\"f1 score: {f1score}\")\n"],"metadata":{"id":"nj3jEnlia-DG","executionInfo":{"status":"ok","timestamp":1686374136499,"user_tz":420,"elapsed":316,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["from datasets import Dataset, load_metric\n","from sklearn.metrics import accuracy_score\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification, TrainingArguments, Trainer\n","import torch\n","import numpy as np\n","\n","taskA_train = Dataset.from_list(taskA_train)\n","taskA_dev = Dataset.from_list(taskA_dev)\n","taskA_test = Dataset.from_list(taskA_test)\n","taskB_train = Dataset.from_list(taskB_train)\n","taskB_dev = Dataset.from_list(taskB_dev)\n","taskB_test = Dataset.from_list(taskB_test)\n","taskC_train = Dataset.from_list(taskC_train)\n","taskC_dev = Dataset.from_list(taskC_dev)\n","taskC_test = Dataset.from_list(taskC_test)"],"metadata":{"id":"4oUQYPCmGFQT","executionInfo":{"status":"ok","timestamp":1686369188135,"user_tz":420,"elapsed":17043,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["taskA_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qgWr398OhP9C","executionInfo":{"status":"ok","timestamp":1686369188135,"user_tz":420,"elapsed":10,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"248b483d-8825-4640-d8ef-fe25d54bbe47"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['rewire_id', 'text', 'label_sexist', 'label_category', 'label_vector', 'split'],\n","    num_rows: 14000\n","})"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["class EDOS(torch.utils.data.Dataset):\n","  def __init__(self, encodings, labels):\n","    self.encodings = encodings\n","    self.labels = labels\n","  \n","  def __getitem__(self, idx):\n","    item = {key: torch.tensor(val[idx]) for key, val in self.encodings.items()}\n","    item['labels'] = torch.tensor(self.labels[idx])\n","    return item\n","\n","  def __len__(self):\n","    return len(self.labels)\n","\n","def compute_metrics(eval_pred):\n","  preds, labels = eval_pred\n","  preds = np.argmax(preds, axis = 1)\n","  return metric.compute(predictions = preds, references = labels)"],"metadata":{"id":"zYVulYdt6RvJ","executionInfo":{"status":"ok","timestamp":1686369188135,"user_tz":420,"elapsed":9,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["\n","model_path = 'distilgpt2'\n","tokenizer = AutoTokenizer.from_pretrained(model_path)\n","tokenizer.pad_token = tokenizer.eos_token\n","taskA_train_encodings = tokenizer(taskA_train['text'], truncation = True, padding = True)\n","taskA_dev_encodings = tokenizer(taskA_dev['text'], truncation = True, padding = True)\n","taskA_test_encodings = tokenizer(taskA_test['text'], truncation = True, padding = True)\n","taskA_train_dataset = EDOS(taskA_train_encodings, taskA_train['label_sexist'])\n","taskA_dev_dataset = EDOS(taskA_dev_encodings, taskA_dev['label_sexist'])\n","taskA_test_dataset = EDOS(taskA_test_encodings, taskA_test['label_sexist'])\n","taskB_train_encodings = tokenizer(taskB_train['text'], truncation = True, padding = True)\n","taskB_dev_encodings = tokenizer(taskB_dev['text'], truncation = True, padding = True)\n","taskB_test_encodings = tokenizer(taskB_test['text'], truncation = True, padding = True)\n","taskB_train_dataset = EDOS(taskB_train_encodings, taskB_train['label_category'])\n","taskB_dev_dataset = EDOS(taskB_dev_encodings, taskB_dev['label_category'])\n","taskB_test_dataset = EDOS(taskB_test_encodings, taskB_test['label_category'])\n","taskC_train_encodings = tokenizer(taskC_train['text'], truncation = True, padding = True)\n","taskC_dev_encodings = tokenizer(taskC_dev['text'], truncation = True, padding = True)\n","taskC_test_encodings = tokenizer(taskC_test['text'], truncation = True, padding = True)\n","taskC_train_dataset = EDOS(taskC_train_encodings, taskC_train['label_vector'])\n","taskC_dev_dataset = EDOS(taskC_dev_encodings, taskC_dev['label_vector'])\n","taskC_test_dataset = EDOS(taskC_test_encodings, taskC_test['label_vector'])\n","metric = load_metric('accuracy')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":212,"referenced_widgets":["c72a5cebdf9748c2b2301a4e44e6322c","7a3915b2509a4a539da3a683a4300f28","efc50b5a249a4fe4a91745b239567e19","a1efde65ff9943d3a85696a801901d93","ac119308fb5344de9836aefd8d09ac69","792998aa92ec40a8907ce1e4e0343a09","271b24b6ee7b469a9234f4f9bd8058da","fdcd9687aa4d463d98adf2488d40adb1","61d5a83bc952407ebbd59c46fa5b9ce2","ec86c7650c214bb98f741c73776e137e","cef6e2a73cf046409cc58f943b188018","8acc69104267434cab72025ee72ca4cb","87f997c1b8c84f7e9598de06c99f8f14","203f2f3c44ef4998a75f13072937bddb","dfa468b9b6384ed184651c506a2392bc","7b085a657c5342b184f5109ebe2bb10a","52825a7f954f47be82cb7d3fe6fb13b8","e58b2098c0a34b8198374487dafe54be","bc3c579c8b7249618138c3111e4f31b2","be694847cd694569bc808e2b94d64327","77ac2ca2fc4e4007a396e415f8afed25","a1506a35a693495bbe9f1fa92054c306","7e7bce32b6324acea4de9a02ea9630f0","87f0c820d7ff4b858e549327e86914cb","26317ef15b2846d48411faee8eb8e527","9269fc58a50442b4bf3700e5ecd9498f","e52032851d324ae1ab55088e977193f2","5273b6571f1e47e49289a8b218d4b685","926d2038672d47418e311e628d92a0de","828267592b1e46deabaa4cf6cbabd8c3","33e12916acd74f62b27c15c4b93fadf3","bf2c4067d43f4d42b71686856974584d","23e1e74056cf4fddac32aab962d154ee","7b55cbef22844086860aee2d18598ca9","beb0d9f3549a4b23aa1dacb4bd66f091","35737c6c38954755a27bee7144053b7c","1d3f6b14c23c4fa692f22b188c7c4e12","7abf973459914462892805ccc16add9c","eae6ae85cafe42359d18fb33d2473125","92ede28d6d8149899e214a5846c4590b","110a9b436c054251aed55e873a00928c","69d93ea5040c4c22a408d63cf6f19974","733e6244f29046da869a4f92e73bc330","91fd3322529a4102b0c352256babc2d2","dd58b224e6024d088290eb5a349ed79c","08a9980ef5194638adc6a7ae686a575f","514b377aaa4647f5b6ce2d0d269dd416","44cecc4347814ae48c3fddfaafb479da","14f9112e4dff465794d5bff682b5cdaf","0f52ce0728b44c088d8bf6fdf93194f9","3ae5066e933b42c88f9bd2d6ef95a203","8c57bed9e9304ce0870bdce2d124fcb8","4acf84e0939849f4904615bc61e81887","8f2bc6992fa346a3a83b3c1d67ffadd5","a6cfc700aa2641a4b77fa4e999925f58"]},"id":"1kTGdqOgkK6h","executionInfo":{"status":"ok","timestamp":1686369195989,"user_tz":420,"elapsed":7863,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"ad2880fe-1e89-4239-881d-4f4928be34a6"},"execution_count":11,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/762 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c72a5cebdf9748c2b2301a4e44e6322c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/vocab.json:   0%|          | 0.00/1.04M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8acc69104267434cab72025ee72ca4cb"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7e7bce32b6324acea4de9a02ea9630f0"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)/main/tokenizer.json:   0%|          | 0.00/1.36M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7b55cbef22844086860aee2d18598ca9"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["<ipython-input-11-784aaaa4a93c>:22: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate\n","  metric = load_metric('accuracy')\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading builder script:   0%|          | 0.00/1.65k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"dd58b224e6024d088290eb5a349ed79c"}},"metadata":{}}]},{"cell_type":"code","source":["batch_size = 64\n","epoch = 10\n","\n","taskA_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"],"metadata":{"id":"IrddTUyqeMdr","executionInfo":{"status":"ok","timestamp":1686369196348,"user_tz":420,"elapsed":367,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["taskA_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 2)\n","taskA_model.config.pad_token_id = tokenizer.pad_token_id\n","\n","taskA_trainer = Trainer(\n","    model = taskA_model,\n","    args = taskA_training_args,\n","    train_dataset = taskA_train_dataset,\n","    eval_dataset = taskA_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskA_trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":853,"referenced_widgets":["b5f3c7c9173942d5a903b4956413d762","09ff3a5909004599bf1f02e41461c197","5eacad84d7734957a16030eed9cdfd45","e4664e50da4d447cad01a036151ec909","61e39c1d87d74b149c550650b46fd1c3","67f3468b88014e849d4cad134bc92a43","3622d9e880524e8e8a031122232abcca","1ee811889edb48f2b51b61c563d582d7","de6ce2d0b7264e61acfb5a5eccc6a366","7e8e2be2cc254feda670b3357da0b950","a60c9b04a5d54d74a13e64d727690f07"]},"id":"mEk8toEV7mIe","executionInfo":{"status":"ok","timestamp":1686371630692,"user_tz":420,"elapsed":2434346,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"9a7bb23b-98fd-412c-bad8-ac4da314e268"},"execution_count":13,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading model.safetensors:   0%|          | 0.00/353M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b5f3c7c9173942d5a903b4956413d762"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at distilgpt2 and are newly initialized: ['score.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='2190' max='2190' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [2190/2190 40:13, Epoch 10/10]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>0.547600</td>\n","      <td>0.516245</td>\n","      <td>0.754500</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>0.507800</td>\n","      <td>0.470858</td>\n","      <td>0.780000</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>0.442700</td>\n","      <td>0.440014</td>\n","      <td>0.806500</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>0.416300</td>\n","      <td>0.407476</td>\n","      <td>0.820500</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>0.376100</td>\n","      <td>0.385133</td>\n","      <td>0.824500</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>0.355900</td>\n","      <td>0.389292</td>\n","      <td>0.826500</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.360500</td>\n","      <td>0.380136</td>\n","      <td>0.831500</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.328500</td>\n","      <td>0.371091</td>\n","      <td>0.837000</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.343000</td>\n","      <td>0.366106</td>\n","      <td>0.842000</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.305500</td>\n","      <td>0.373200</td>\n","      <td>0.836500</td>\n","    </tr>\n","    <tr>\n","      <td>1100</td>\n","      <td>0.313100</td>\n","      <td>0.356155</td>\n","      <td>0.840500</td>\n","    </tr>\n","    <tr>\n","      <td>1200</td>\n","      <td>0.297600</td>\n","      <td>0.357838</td>\n","      <td>0.843000</td>\n","    </tr>\n","    <tr>\n","      <td>1300</td>\n","      <td>0.297100</td>\n","      <td>0.360218</td>\n","      <td>0.847000</td>\n","    </tr>\n","    <tr>\n","      <td>1400</td>\n","      <td>0.285100</td>\n","      <td>0.358834</td>\n","      <td>0.845500</td>\n","    </tr>\n","    <tr>\n","      <td>1500</td>\n","      <td>0.286700</td>\n","      <td>0.357656</td>\n","      <td>0.848500</td>\n","    </tr>\n","    <tr>\n","      <td>1600</td>\n","      <td>0.273500</td>\n","      <td>0.363730</td>\n","      <td>0.844000</td>\n","    </tr>\n","    <tr>\n","      <td>1700</td>\n","      <td>0.281100</td>\n","      <td>0.358487</td>\n","      <td>0.850500</td>\n","    </tr>\n","    <tr>\n","      <td>1800</td>\n","      <td>0.261100</td>\n","      <td>0.371719</td>\n","      <td>0.844500</td>\n","    </tr>\n","    <tr>\n","      <td>1900</td>\n","      <td>0.267500</td>\n","      <td>0.360266</td>\n","      <td>0.847000</td>\n","    </tr>\n","    <tr>\n","      <td>2000</td>\n","      <td>0.269300</td>\n","      <td>0.359051</td>\n","      <td>0.849000</td>\n","    </tr>\n","    <tr>\n","      <td>2100</td>\n","      <td>0.250300</td>\n","      <td>0.363404</td>\n","      <td>0.848000</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=2190, training_loss=0.3337927178160785, metrics={'train_runtime': 2417.1634, 'train_samples_per_second': 57.919, 'train_steps_per_second': 0.906, 'total_flos': 6037601955840000.0, 'train_loss': 0.3337927178160785, 'epoch': 10.0})"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["y_pred = taskA_trainer.predict(taskA_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskA_test['label_sexist'], y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":86},"id":"mdjmh0xxUNyf","executionInfo":{"status":"ok","timestamp":1686374196070,"user_tz":420,"elapsed":54235,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"038ae82c-7b76-4f4d-e996-a7c7ccecc7f0"},"execution_count":32,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.86325\n","precision: 0.8579217150298979\n","recall: 0.86325\n","f1 score: 0.8583257677387002\n"]}]},{"cell_type":"code","source":["epoch = 20\n","\n","taskB_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"],"metadata":{"id":"MDQXHAiEI0So","executionInfo":{"status":"ok","timestamp":1686371683904,"user_tz":420,"elapsed":13,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["taskB_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 4)\n","taskB_model.config.pad_token_id = tokenizer.pad_token_id\n","\n","taskB_trainer = Trainer(\n","    model = taskB_model,\n","    args = taskB_training_args,\n","    train_dataset = taskB_train_dataset,\n","    eval_dataset = taskB_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskB_trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":476},"id":"5GDjuxJc7JgE","executionInfo":{"status":"ok","timestamp":1686372423685,"user_tz":420,"elapsed":739794,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"74b55710-0f2f-4c54-a4f4-ee1e792d816b"},"execution_count":16,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at distilgpt2 and are newly initialized: ['score.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='1080' max='1080' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1080/1080 12:16, Epoch 20/20]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>1.536800</td>\n","      <td>1.150905</td>\n","      <td>0.401235</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>1.094600</td>\n","      <td>1.079973</td>\n","      <td>0.456790</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>0.994300</td>\n","      <td>1.036252</td>\n","      <td>0.508230</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>0.905200</td>\n","      <td>1.011790</td>\n","      <td>0.543210</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>0.833000</td>\n","      <td>1.006831</td>\n","      <td>0.561728</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>0.778900</td>\n","      <td>1.015484</td>\n","      <td>0.559671</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.749300</td>\n","      <td>1.035819</td>\n","      <td>0.567901</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.698600</td>\n","      <td>1.076820</td>\n","      <td>0.524691</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.686000</td>\n","      <td>1.085194</td>\n","      <td>0.532922</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.656100</td>\n","      <td>1.074417</td>\n","      <td>0.547325</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=1080, training_loss=0.8755669805738661, metrics={'train_runtime': 736.6879, 'train_samples_per_second': 92.251, 'train_steps_per_second': 1.466, 'total_flos': 1925048921702400.0, 'train_loss': 0.8755669805738661, 'epoch': 20.0})"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["y_pred = taskB_trainer.predict(taskB_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskB_test['label_category'], y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":86},"id":"9N2hdhecUsAl","executionInfo":{"status":"ok","timestamp":1686374235604,"user_tz":420,"elapsed":3258,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"4a44437b-a739-49b6-de2a-65428e1f3937"},"execution_count":33,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.50206\n","precision: 0.5104267843537342\n","recall: 0.5020618556701031\n","f1 score: 0.5021022819094771\n"]}]},{"cell_type":"code","source":["epoch = 20\n","\n","taskC_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"],"metadata":{"id":"f8lxE34sJZMy","executionInfo":{"status":"ok","timestamp":1686372426175,"user_tz":420,"elapsed":2,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["taskC_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 11)\n","taskC_model.config.pad_token_id = tokenizer.pad_token_id\n","\n","taskC_trainer = Trainer(\n","    model = taskC_model,\n","    args = taskC_training_args,\n","    train_dataset = taskC_train_dataset,\n","    eval_dataset = taskC_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskC_trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":476},"id":"4F3kecvO7SsS","executionInfo":{"status":"ok","timestamp":1686373172991,"user_tz":420,"elapsed":746817,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"af506083-daa0-4c41-9338-be4748880827"},"execution_count":19,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at distilgpt2 and are newly initialized: ['score.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='1080' max='1080' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1080/1080 12:24, Epoch 20/20]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>2.217800</td>\n","      <td>1.978454</td>\n","      <td>0.286008</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>1.867500</td>\n","      <td>1.834231</td>\n","      <td>0.335391</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>1.702800</td>\n","      <td>1.734280</td>\n","      <td>0.376543</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>1.569600</td>\n","      <td>1.686087</td>\n","      <td>0.421811</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>1.479400</td>\n","      <td>1.656749</td>\n","      <td>0.440329</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>1.385600</td>\n","      <td>1.659557</td>\n","      <td>0.440329</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>1.337900</td>\n","      <td>1.657959</td>\n","      <td>0.446502</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>1.280600</td>\n","      <td>1.659208</td>\n","      <td>0.450617</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>1.253700</td>\n","      <td>1.654190</td>\n","      <td>0.446502</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>1.215100</td>\n","      <td>1.664686</td>\n","      <td>0.444444</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=1080, training_loss=1.507758938824689, metrics={'train_runtime': 745.2281, 'train_samples_per_second': 91.194, 'train_steps_per_second': 1.449, 'total_flos': 1925292246773760.0, 'train_loss': 1.507758938824689, 'epoch': 20.0})"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["y_pred = taskC_trainer.predict(taskC_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskC_test['label_vector'], y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":121},"id":"TbtvL8X_UwDi","executionInfo":{"status":"ok","timestamp":1686374261429,"user_tz":420,"elapsed":2968,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}},"outputId":"c88c8bd8-22cc-4feb-bc4e-ab5586861cb6"},"execution_count":35,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.42165\n","precision: 0.3879242427290343\n","recall: 0.4216494845360825\n","f1 score: 0.397024200670792\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"o-XdZN9qtlrn","executionInfo":{"status":"ok","timestamp":1686373175666,"user_tz":420,"elapsed":133,"user":{"displayName":"EN-TIEN LIN","userId":"07788994505519523962"}}},"execution_count":20,"outputs":[]}]}