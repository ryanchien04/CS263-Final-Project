{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"gpuType":"T4","authorship_tag":"ABX9TyOBciMyiJHDfzeK/xKwYxQk"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"696da2944cc14f0fb8febc6bf2ebfd71":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_26fd01cd08e94137aa411932d2fb6242","IPY_MODEL_5c187a0deceb4cab8ebd0f5c0ea022c2","IPY_MODEL_879086be340c4d51913684afdb1ca552"],"layout":"IPY_MODEL_480b642102b34335b1ede6fc24655438"}},"26fd01cd08e94137aa411932d2fb6242":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_25783ef6196d417c81374578693391e9","placeholder":"​","style":"IPY_MODEL_0ae6a6b64c9345fa80ad6a0956c7ec49","value":"Downloading (…)lve/main/config.json: 100%"}},"5c187a0deceb4cab8ebd0f5c0ea022c2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f996d5f00b7b428ebbbc724bc47be697","max":480,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5cf8e82f3998430581501383c0bf5097","value":480}},"879086be340c4d51913684afdb1ca552":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_963ad9a8bb744e8bb0323f13a11f335b","placeholder":"​","style":"IPY_MODEL_90b264de91384f5f9c38797ccb0cb970","value":" 480/480 [00:00&lt;00:00, 14.9kB/s]"}},"480b642102b34335b1ede6fc24655438":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"25783ef6196d417c81374578693391e9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ae6a6b64c9345fa80ad6a0956c7ec49":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f996d5f00b7b428ebbbc724bc47be697":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5cf8e82f3998430581501383c0bf5097":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"963ad9a8bb744e8bb0323f13a11f335b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"90b264de91384f5f9c38797ccb0cb970":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0ca7520a553648babfd1337fcc185ce8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e593fe65b2dd431db9c56020f7178406","IPY_MODEL_4361a57d134c4a47b72a5aeb6b8427d5","IPY_MODEL_815ca107777d405db759a0496fc94d4c"],"layout":"IPY_MODEL_d369165ae18a4f2e834601cb7055cbb9"}},"e593fe65b2dd431db9c56020f7178406":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2e3e2236c8d7452b85d45cee37b9c5b4","placeholder":"​","style":"IPY_MODEL_92cce50f0ae94e44ad059d44cac4c15a","value":"Downloading (…)olve/main/vocab.json: 100%"}},"4361a57d134c4a47b72a5aeb6b8427d5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_834581d9ff7841f1842876fda4b6c0aa","max":898823,"min":0,"orientation":"horizontal","style":"IPY_MODEL_af4a50783fa046bfaf5c61a0cb627bc5","value":898823}},"815ca107777d405db759a0496fc94d4c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_27814f1acada4a968e62352ba2e60043","placeholder":"​","style":"IPY_MODEL_936a1cec29244088afb8101a6a8f5523","value":" 899k/899k [00:00&lt;00:00, 1.07MB/s]"}},"d369165ae18a4f2e834601cb7055cbb9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2e3e2236c8d7452b85d45cee37b9c5b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"92cce50f0ae94e44ad059d44cac4c15a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"834581d9ff7841f1842876fda4b6c0aa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af4a50783fa046bfaf5c61a0cb627bc5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"27814f1acada4a968e62352ba2e60043":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"936a1cec29244088afb8101a6a8f5523":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dff0467c10d04fc2bedde84dc9fe444b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e2e12efeaa20499889ced855b48a2447","IPY_MODEL_1dcc216a956440bd84b1b2093975fe3a","IPY_MODEL_0ca74faff2074e07bd336912906078a8"],"layout":"IPY_MODEL_9069341efbd647feb0176056ddbfecaf"}},"e2e12efeaa20499889ced855b48a2447":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9bef7fb922e54fefb11a0c27d785a609","placeholder":"​","style":"IPY_MODEL_0fd608f0f7054f8294e04dd37ce2a642","value":"Downloading (…)olve/main/merges.txt: 100%"}},"1dcc216a956440bd84b1b2093975fe3a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_64c68f05937b4925bb2cef91760581b8","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7577a894e9f94093b828041b35b3abce","value":456318}},"0ca74faff2074e07bd336912906078a8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1f0f00c20c72497790740f2a004fc0c2","placeholder":"​","style":"IPY_MODEL_6add9a193c1342edb632a149e182b4ce","value":" 456k/456k [00:00&lt;00:00, 1.10MB/s]"}},"9069341efbd647feb0176056ddbfecaf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9bef7fb922e54fefb11a0c27d785a609":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0fd608f0f7054f8294e04dd37ce2a642":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"64c68f05937b4925bb2cef91760581b8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7577a894e9f94093b828041b35b3abce":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1f0f00c20c72497790740f2a004fc0c2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6add9a193c1342edb632a149e182b4ce":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c874196c78c34278bd7ec26d3aa1939a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6c7ad76b31074ca8a7b54f4c138ce3cc","IPY_MODEL_4b0f708256f946a6a0f17b868192eea7","IPY_MODEL_6534aacdfe464c099f28a3fcfa1a4622"],"layout":"IPY_MODEL_860c7229fd484616a1f7d9ba9d58c2e1"}},"6c7ad76b31074ca8a7b54f4c138ce3cc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2a9fc5ce5a9a43b4afd4d662ad78e4e0","placeholder":"​","style":"IPY_MODEL_804821a172b349faa7730559fcffacd7","value":"Downloading (…)/main/tokenizer.json: 100%"}},"4b0f708256f946a6a0f17b868192eea7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5828a38ef07a458d85c3cbfd3bb10c02","max":1355863,"min":0,"orientation":"horizontal","style":"IPY_MODEL_74085778033148c7b308eaf5051e8ad4","value":1355863}},"6534aacdfe464c099f28a3fcfa1a4622":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bc6c28a9e72b4a4984aacd0db882f6e8","placeholder":"​","style":"IPY_MODEL_ec2e17730ada4fc3ba2bcba88a6bd7ae","value":" 1.36M/1.36M [00:01&lt;00:00, 1.30MB/s]"}},"860c7229fd484616a1f7d9ba9d58c2e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2a9fc5ce5a9a43b4afd4d662ad78e4e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"804821a172b349faa7730559fcffacd7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5828a38ef07a458d85c3cbfd3bb10c02":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"74085778033148c7b308eaf5051e8ad4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bc6c28a9e72b4a4984aacd0db882f6e8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ec2e17730ada4fc3ba2bcba88a6bd7ae":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d6f4d042523a404fac13ae9e27bee127":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8081e9d6176b47ea8dd673ef97a8ba03","IPY_MODEL_ddf484cf1d914698984721dca4886948","IPY_MODEL_bfcdaa60e7e54dfeb0546a962b8eeac2"],"layout":"IPY_MODEL_31d318c9e3a2474e8375957572fe6e57"}},"8081e9d6176b47ea8dd673ef97a8ba03":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_50f81a1361a14dfa9bf947183a16e31d","placeholder":"​","style":"IPY_MODEL_fb7a15b348fb4c2b96d4f8f51cce08bc","value":"Downloading model.safetensors: 100%"}},"ddf484cf1d914698984721dca4886948":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_23111968053b459cace2c743842aa867","max":331055963,"min":0,"orientation":"horizontal","style":"IPY_MODEL_31ffe53b537e45ae9b937713ac62c8c6","value":331055963}},"bfcdaa60e7e54dfeb0546a962b8eeac2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_55dc4729de1a434a9c522c86d7dfb429","placeholder":"​","style":"IPY_MODEL_a3861773e5ae4c13be9c655a99e9e170","value":" 331M/331M [00:02&lt;00:00, 158MB/s]"}},"31d318c9e3a2474e8375957572fe6e57":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"50f81a1361a14dfa9bf947183a16e31d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb7a15b348fb4c2b96d4f8f51cce08bc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"23111968053b459cace2c743842aa867":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"31ffe53b537e45ae9b937713ac62c8c6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"55dc4729de1a434a9c522c86d7dfb429":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a3861773e5ae4c13be9c655a99e9e170":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sqnV1wnV_iHU","executionInfo":{"status":"ok","timestamp":1686374886283,"user_tz":420,"elapsed":3068,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"b24312b0-7937-4911-f40a-bdb15fb90426"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n","/content/drive/Shareddrives/CS263\n"]}],"source":["import os\n","from google.colab import drive\n","drive.mount('/content/drive')\n","%cd /content/drive/Shareddrives/CS263"]},{"cell_type":"code","source":["#!pip install datasets\n","#!pip install transformers[torch]"],"metadata":{"id":"O0hye2QojNR0","executionInfo":{"status":"ok","timestamp":1686374886283,"user_tz":420,"elapsed":7,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["import csv\n","\n","label_dict = {'not sexist': 0, 'sexist': 1}\n","category_dict = {'1. threats, plans to harm and incitement': 0, '2. derogation': 1, '3. animosity': 2, '4. prejudiced discussions': 3, 'none': 4}\n","vector_dict = {\n","    '1.1 threats of harm': 0, \n","    '1.2 incitement and encouragement of harm': 1, \n","    '2.1 descriptive attacks': 2,\n","    '2.2 aggressive and emotive attacks': 3,\n","    '2.3 dehumanising attacks & overt sexual objectification': 4,\n","    '3.1 casual use of gendered slurs, profanities, and insults': 5,\n","    '3.2 immutable gender differences and gender stereotypes': 6,\n","    '3.3 backhanded gendered compliments': 7,\n","    '3.4 condescending explanations or unwelcome advice': 8,\n","    '4.1 supporting mistreatment of individual women': 9,\n","    '4.2 supporting systemic discrimination against women as a group': 10,\n","    'none': 0,\n","    }\n","\n","with open('edos_labelled_aggregated.csv') as file:\n","  data = list(csv.reader(file, quotechar='\"')) \n","  taskA_train = []\n","  taskA_dev = []\n","  taskA_test = []\n","  taskB_train = []\n","  taskB_dev = []\n","  taskB_test = []\n","  taskC_train = []\n","  taskC_dev = []\n","  taskC_test = []\n","  for i in range(len(data)):\n","    if i == 0:\n","      continue\n","    \n","    temp_dict = {\n","        'rewire_id': data[i][0], \n","        'text': data[i][1], \n","        'label_sexist': label_dict[data[i][2]], \n","        'label_category': category_dict[data[i][3]],\n","        'label_vector': vector_dict[data[i][4]],\n","        'split': data[i][5]\n","        }\n","\n","    if temp_dict['split'] == 'train':\n","      taskA_train.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_train.append(temp_dict)\n","        taskC_train.append(temp_dict)\n","    elif temp_dict['split'] == 'dev':\n","      taskA_dev.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_dev.append(temp_dict)\n","        taskC_dev.append(temp_dict)\n","    else:\n","      taskA_test.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_test.append(temp_dict)\n","        taskC_test.append(temp_dict)\n"],"metadata":{"id":"_AdDAamfAPhl","executionInfo":{"status":"ok","timestamp":1686374886283,"user_tz":420,"elapsed":5,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["print(len(taskA_train), len(taskA_dev), len(taskA_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4VzyUYtfA_6J","executionInfo":{"status":"ok","timestamp":1686374886283,"user_tz":420,"elapsed":4,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"91e0aaf3-0340-4d29-a979-8d95c84add98"},"execution_count":16,"outputs":[{"output_type":"stream","name":"stdout","text":["14000 2000 4000\n"]}]},{"cell_type":"code","source":["print(len(taskB_train), len(taskB_dev), len(taskB_test))  "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Z17kv9oNFsbc","executionInfo":{"status":"ok","timestamp":1686374886284,"user_tz":420,"elapsed":4,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"d5031464-03b2-4a85-fdd9-dc7c742ab4a6"},"execution_count":17,"outputs":[{"output_type":"stream","name":"stdout","text":["3398 486 970\n"]}]},{"cell_type":"code","source":["print(len(taskC_train), len(taskC_dev), len(taskC_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ynYNkDf4FtBr","executionInfo":{"status":"ok","timestamp":1686374886284,"user_tz":420,"elapsed":3,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"67e51356-9e3d-4c74-ad8a-2f9b6a61af5c"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["3398 486 970\n"]}]},{"cell_type":"code","source":["from sklearn.metrics import (accuracy_score, \n","                             auc,\n","                             confusion_matrix,\n","                              precision_score,\n","                              recall_score,\n","                              f1_score\n","                            )\n","\n","def get_acc(y_test, y_pred):\n","    acc = round(accuracy_score(y_test,y_pred), 5)\n","    precision = precision_score(y_test, y_pred, average='weighted')\n","    recall = recall_score(y_test, y_pred, average='weighted')\n","    f1score = f1_score(y_test, y_pred, average='weighted')\n","    print(f\"Accuracy: {acc}\")\n","    print(f\"precision: {precision}\")\n","    print(f\"recall: {recall}\")\n","    print(f\"f1 score: {f1score}\")"],"metadata":{"id":"ZkGRiN2ZEHDA","executionInfo":{"status":"ok","timestamp":1686379724684,"user_tz":420,"elapsed":366,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":38,"outputs":[]},{"cell_type":"code","source":["from datasets import Dataset, load_metric\n","from sklearn.metrics import accuracy_score\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification, TrainingArguments, Trainer\n","import torch\n","import numpy as np\n","\n","taskA_train = Dataset.from_list(taskA_train)\n","taskA_dev = Dataset.from_list(taskA_dev)\n","taskA_test = Dataset.from_list(taskA_test)\n","taskB_train = Dataset.from_list(taskB_train)\n","taskB_dev = Dataset.from_list(taskB_dev)\n","taskB_test = Dataset.from_list(taskB_test)\n","taskC_train = Dataset.from_list(taskC_train)\n","taskC_dev = Dataset.from_list(taskC_dev)\n","taskC_test = Dataset.from_list(taskC_test)"],"metadata":{"id":"4oUQYPCmGFQT","executionInfo":{"status":"ok","timestamp":1686374886908,"user_tz":420,"elapsed":626,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["taskA_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qgWr398OhP9C","executionInfo":{"status":"ok","timestamp":1686374886909,"user_tz":420,"elapsed":3,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"e6ad94e1-59a6-481e-80bf-9c7c77d21fa0"},"execution_count":20,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['rewire_id', 'text', 'label_sexist', 'label_category', 'label_vector', 'split'],\n","    num_rows: 14000\n","})"]},"metadata":{},"execution_count":20}]},{"cell_type":"code","source":["class EDOS(torch.utils.data.Dataset):\n","  def __init__(self, encodings, labels):\n","    self.encodings = encodings\n","    self.labels = labels\n","  \n","  def __getitem__(self, idx):\n","    item = {key: torch.tensor(val[idx]) for key, val in self.encodings.items()}\n","    item['labels'] = torch.tensor(self.labels[idx])\n","    return item\n","\n","  def __len__(self):\n","    return len(self.labels)\n","\n","def compute_metrics(eval_pred):\n","  preds, labels = eval_pred\n","  preds = np.argmax(preds, axis = 1)\n","  return metric.compute(predictions = preds, references = labels)"],"metadata":{"id":"zYVulYdt6RvJ","executionInfo":{"status":"ok","timestamp":1686374886909,"user_tz":420,"elapsed":2,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["!pip install sentencepiece"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kTS_MzjNyKlE","executionInfo":{"status":"ok","timestamp":1686375033208,"user_tz":420,"elapsed":10222,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"01b88882-32be-4df7-9f9e-900f0414fd41"},"execution_count":24,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting sentencepiece\n","  Downloading sentencepiece-0.1.99-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m51.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: sentencepiece\n","Successfully installed sentencepiece-0.1.99\n"]}]},{"cell_type":"code","source":["model_path = 'distilroberta-base'\n","tokenizer = AutoTokenizer.from_pretrained(model_path)\n","taskA_train_encodings = tokenizer(taskA_train['text'], truncation = True, padding = True)\n","taskA_dev_encodings = tokenizer(taskA_dev['text'], truncation = True, padding = True)\n","taskA_test_encodings = tokenizer(taskA_test['text'], truncation = True, padding = True)\n","taskA_train_dataset = EDOS(taskA_train_encodings, taskA_train['label_sexist'])\n","taskA_dev_dataset = EDOS(taskA_dev_encodings, taskA_dev['label_sexist'])\n","taskA_test_dataset = EDOS(taskA_test_encodings, taskA_test['label_sexist'])\n","taskB_train_encodings = tokenizer(taskB_train['text'], truncation = True, padding = True)\n","taskB_dev_encodings = tokenizer(taskB_dev['text'], truncation = True, padding = True)\n","taskB_test_encodings = tokenizer(taskB_test['text'], truncation = True, padding = True)\n","taskB_train_dataset = EDOS(taskB_train_encodings, taskB_train['label_category'])\n","taskB_dev_dataset = EDOS(taskB_dev_encodings, taskB_dev['label_category'])\n","taskB_test_dataset = EDOS(taskB_test_encodings, taskB_test['label_category'])\n","taskC_train_encodings = tokenizer(taskC_train['text'], truncation = True, padding = True)\n","taskC_dev_encodings = tokenizer(taskC_dev['text'], truncation = True, padding = True)\n","taskC_test_encodings = tokenizer(taskC_test['text'], truncation = True, padding = True)\n","taskC_train_dataset = EDOS(taskC_train_encodings, taskC_train['label_vector'])\n","taskC_dev_dataset = EDOS(taskC_dev_encodings, taskC_dev['label_vector'])\n","taskC_test_dataset = EDOS(taskC_test_encodings, taskC_test['label_vector'])\n","metric = load_metric('accuracy')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":145,"referenced_widgets":["696da2944cc14f0fb8febc6bf2ebfd71","26fd01cd08e94137aa411932d2fb6242","5c187a0deceb4cab8ebd0f5c0ea022c2","879086be340c4d51913684afdb1ca552","480b642102b34335b1ede6fc24655438","25783ef6196d417c81374578693391e9","0ae6a6b64c9345fa80ad6a0956c7ec49","f996d5f00b7b428ebbbc724bc47be697","5cf8e82f3998430581501383c0bf5097","963ad9a8bb744e8bb0323f13a11f335b","90b264de91384f5f9c38797ccb0cb970","0ca7520a553648babfd1337fcc185ce8","e593fe65b2dd431db9c56020f7178406","4361a57d134c4a47b72a5aeb6b8427d5","815ca107777d405db759a0496fc94d4c","d369165ae18a4f2e834601cb7055cbb9","2e3e2236c8d7452b85d45cee37b9c5b4","92cce50f0ae94e44ad059d44cac4c15a","834581d9ff7841f1842876fda4b6c0aa","af4a50783fa046bfaf5c61a0cb627bc5","27814f1acada4a968e62352ba2e60043","936a1cec29244088afb8101a6a8f5523","dff0467c10d04fc2bedde84dc9fe444b","e2e12efeaa20499889ced855b48a2447","1dcc216a956440bd84b1b2093975fe3a","0ca74faff2074e07bd336912906078a8","9069341efbd647feb0176056ddbfecaf","9bef7fb922e54fefb11a0c27d785a609","0fd608f0f7054f8294e04dd37ce2a642","64c68f05937b4925bb2cef91760581b8","7577a894e9f94093b828041b35b3abce","1f0f00c20c72497790740f2a004fc0c2","6add9a193c1342edb632a149e182b4ce","c874196c78c34278bd7ec26d3aa1939a","6c7ad76b31074ca8a7b54f4c138ce3cc","4b0f708256f946a6a0f17b868192eea7","6534aacdfe464c099f28a3fcfa1a4622","860c7229fd484616a1f7d9ba9d58c2e1","2a9fc5ce5a9a43b4afd4d662ad78e4e0","804821a172b349faa7730559fcffacd7","5828a38ef07a458d85c3cbfd3bb10c02","74085778033148c7b308eaf5051e8ad4","bc6c28a9e72b4a4984aacd0db882f6e8","ec2e17730ada4fc3ba2bcba88a6bd7ae"]},"id":"1kTGdqOgkK6h","executionInfo":{"status":"ok","timestamp":1686375115613,"user_tz":420,"elapsed":16880,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"f4f233ca-4a88-44ad-8697-26c18b3904c0"},"execution_count":27,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/480 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"696da2944cc14f0fb8febc6bf2ebfd71"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0ca7520a553648babfd1337fcc185ce8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"dff0467c10d04fc2bedde84dc9fe444b"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)/main/tokenizer.json:   0%|          | 0.00/1.36M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c874196c78c34278bd7ec26d3aa1939a"}},"metadata":{}}]},{"cell_type":"code","source":["batch_size = 64\n","epoch = 10\n","\n","taskA_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"],"metadata":{"id":"IrddTUyqeMdr","executionInfo":{"status":"ok","timestamp":1686375153237,"user_tz":420,"elapsed":525,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":28,"outputs":[]},{"cell_type":"code","source":["taskA_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 2)\n","\n","taskA_trainer = Trainer(\n","    model = taskA_model,\n","    args = taskA_training_args,\n","    train_dataset = taskA_train_dataset,\n","    eval_dataset = taskA_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskA_trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":942,"referenced_widgets":["d6f4d042523a404fac13ae9e27bee127","8081e9d6176b47ea8dd673ef97a8ba03","ddf484cf1d914698984721dca4886948","bfcdaa60e7e54dfeb0546a962b8eeac2","31d318c9e3a2474e8375957572fe6e57","50f81a1361a14dfa9bf947183a16e31d","fb7a15b348fb4c2b96d4f8f51cce08bc","23111968053b459cace2c743842aa867","31ffe53b537e45ae9b937713ac62c8c6","55dc4729de1a434a9c522c86d7dfb429","a3861773e5ae4c13be9c655a99e9e170"]},"id":"mEk8toEV7mIe","executionInfo":{"status":"ok","timestamp":1686377155220,"user_tz":420,"elapsed":1999888,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"22b907f5-48eb-4b8a-faf8-79eb6ecc836f"},"execution_count":29,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading model.safetensors:   0%|          | 0.00/331M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d6f4d042523a404fac13ae9e27bee127"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilroberta-base were not used when initializing RobertaForSequenceClassification: ['lm_head.bias', 'roberta.pooler.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'roberta.pooler.dense.weight', 'lm_head.dense.weight', 'lm_head.dense.bias']\n","- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at distilroberta-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.bias', 'classifier.out_proj.bias', 'classifier.dense.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='2190' max='2190' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [2190/2190 33:13, Epoch 10/10]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>0.517400</td>\n","      <td>0.423329</td>\n","      <td>0.792000</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>0.400800</td>\n","      <td>0.351971</td>\n","      <td>0.838500</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>0.334700</td>\n","      <td>0.366357</td>\n","      <td>0.854500</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>0.331200</td>\n","      <td>0.325963</td>\n","      <td>0.858000</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>0.306800</td>\n","      <td>0.326475</td>\n","      <td>0.853500</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>0.285500</td>\n","      <td>0.324935</td>\n","      <td>0.868000</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.283100</td>\n","      <td>0.357738</td>\n","      <td>0.859000</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.252200</td>\n","      <td>0.330427</td>\n","      <td>0.871000</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.259700</td>\n","      <td>0.331064</td>\n","      <td>0.866500</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.219800</td>\n","      <td>0.352420</td>\n","      <td>0.861000</td>\n","    </tr>\n","    <tr>\n","      <td>1100</td>\n","      <td>0.235000</td>\n","      <td>0.329536</td>\n","      <td>0.865500</td>\n","    </tr>\n","    <tr>\n","      <td>1200</td>\n","      <td>0.214600</td>\n","      <td>0.334655</td>\n","      <td>0.866000</td>\n","    </tr>\n","    <tr>\n","      <td>1300</td>\n","      <td>0.199200</td>\n","      <td>0.350877</td>\n","      <td>0.865500</td>\n","    </tr>\n","    <tr>\n","      <td>1400</td>\n","      <td>0.181900</td>\n","      <td>0.365514</td>\n","      <td>0.866000</td>\n","    </tr>\n","    <tr>\n","      <td>1500</td>\n","      <td>0.195000</td>\n","      <td>0.359849</td>\n","      <td>0.865000</td>\n","    </tr>\n","    <tr>\n","      <td>1600</td>\n","      <td>0.173600</td>\n","      <td>0.369644</td>\n","      <td>0.868500</td>\n","    </tr>\n","    <tr>\n","      <td>1700</td>\n","      <td>0.176100</td>\n","      <td>0.376587</td>\n","      <td>0.862000</td>\n","    </tr>\n","    <tr>\n","      <td>1800</td>\n","      <td>0.157500</td>\n","      <td>0.374936</td>\n","      <td>0.864000</td>\n","    </tr>\n","    <tr>\n","      <td>1900</td>\n","      <td>0.164000</td>\n","      <td>0.380660</td>\n","      <td>0.862000</td>\n","    </tr>\n","    <tr>\n","      <td>2000</td>\n","      <td>0.157300</td>\n","      <td>0.384319</td>\n","      <td>0.867500</td>\n","    </tr>\n","    <tr>\n","      <td>2100</td>\n","      <td>0.144000</td>\n","      <td>0.386454</td>\n","      <td>0.867000</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=2190, training_loss=0.24356545835869498, metrics={'train_runtime': 1994.6147, 'train_samples_per_second': 70.189, 'train_steps_per_second': 1.098, 'total_flos': 6193885788720000.0, 'train_loss': 0.24356545835869498, 'epoch': 10.0})"]},"metadata":{},"execution_count":29}]},{"cell_type":"code","source":["y_pred = taskA_trainer.predict(taskA_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskA_test['label_sexist'], y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":86},"id":"mdjmh0xxUNyf","executionInfo":{"status":"ok","timestamp":1686379773437,"user_tz":420,"elapsed":41136,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"ce1fefb8-81f4-4e72-8d17-944f5a977c51"},"execution_count":39,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.85625\n","precision: 0.85868721687254\n","recall: 0.85625\n","f1 score: 0.8573416898559648\n"]}]},{"cell_type":"code","source":["epoch = 20\n","\n","taskB_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"],"metadata":{"id":"MDQXHAiEI0So","executionInfo":{"status":"ok","timestamp":1686377973692,"user_tz":420,"elapsed":340,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["taskB_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 4)\n","\n","taskB_trainer = Trainer(\n","    model = taskB_model,\n","    args = taskB_training_args,\n","    train_dataset = taskB_train_dataset,\n","    eval_dataset = taskB_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskB_trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":565},"id":"5GDjuxJc7JgE","executionInfo":{"status":"ok","timestamp":1686378581472,"user_tz":420,"elapsed":604835,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"07f23911-7f1f-4833-8fe7-939f096d5b40"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilroberta-base were not used when initializing RobertaForSequenceClassification: ['lm_head.bias', 'roberta.pooler.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'roberta.pooler.dense.weight', 'lm_head.dense.weight', 'lm_head.dense.bias']\n","- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at distilroberta-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.bias', 'classifier.out_proj.bias', 'classifier.dense.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='1080' max='1080' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1080/1080 09:58, Epoch 20/20]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>1.139200</td>\n","      <td>0.954147</td>\n","      <td>0.549383</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>0.897300</td>\n","      <td>0.905407</td>\n","      <td>0.588477</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>0.784300</td>\n","      <td>0.845839</td>\n","      <td>0.633745</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>0.669800</td>\n","      <td>0.858765</td>\n","      <td>0.621399</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>0.578300</td>\n","      <td>0.882618</td>\n","      <td>0.627572</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>0.503900</td>\n","      <td>0.911909</td>\n","      <td>0.627572</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.455600</td>\n","      <td>0.959432</td>\n","      <td>0.633745</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.400700</td>\n","      <td>1.007136</td>\n","      <td>0.596708</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.360700</td>\n","      <td>1.022260</td>\n","      <td>0.627572</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.343600</td>\n","      <td>1.035806</td>\n","      <td>0.625514</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=1080, training_loss=0.59204655929848, metrics={'train_runtime': 598.7546, 'train_samples_per_second': 113.502, 'train_steps_per_second': 1.804, 'total_flos': 1986947308879680.0, 'train_loss': 0.59204655929848, 'epoch': 20.0})"]},"metadata":{},"execution_count":32}]},{"cell_type":"code","source":["y_pred = taskB_trainer.predict(taskB_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskB_test['label_category'], y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":86},"id":"9N2hdhecUsAl","executionInfo":{"status":"ok","timestamp":1686379858604,"user_tz":420,"elapsed":2915,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"bbd961c3-7fed-4b41-d1c0-5137aaacbec4"},"execution_count":41,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.58763\n","precision: 0.5814603154826613\n","recall: 0.5876288659793815\n","f1 score: 0.5772458684650419\n"]}]},{"cell_type":"code","source":["epoch = 20\n","\n","taskC_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"],"metadata":{"id":"f8lxE34sJZMy","executionInfo":{"status":"ok","timestamp":1686378725533,"user_tz":420,"elapsed":336,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}}},"execution_count":34,"outputs":[]},{"cell_type":"code","source":["taskC_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 11)\n","\n","taskC_trainer = Trainer(\n","    model = taskC_model,\n","    args = taskC_training_args,\n","    train_dataset = taskC_train_dataset,\n","    eval_dataset = taskC_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskC_trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":565},"id":"4F3kecvO7SsS","executionInfo":{"status":"ok","timestamp":1686379321108,"user_tz":420,"elapsed":593388,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"d7475a8c-5fcc-4084-cd69-644322f67ac1"},"execution_count":35,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilroberta-base were not used when initializing RobertaForSequenceClassification: ['lm_head.bias', 'roberta.pooler.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'roberta.pooler.dense.weight', 'lm_head.dense.weight', 'lm_head.dense.bias']\n","- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at distilroberta-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.bias', 'classifier.out_proj.bias', 'classifier.dense.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='1080' max='1080' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1080/1080 09:50, Epoch 20/20]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>2.028800</td>\n","      <td>1.777140</td>\n","      <td>0.358025</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>1.599200</td>\n","      <td>1.540919</td>\n","      <td>0.465021</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>1.412200</td>\n","      <td>1.457636</td>\n","      <td>0.495885</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>1.269700</td>\n","      <td>1.407612</td>\n","      <td>0.512346</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>1.140000</td>\n","      <td>1.392217</td>\n","      <td>0.512346</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>1.055400</td>\n","      <td>1.406936</td>\n","      <td>0.530864</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.980800</td>\n","      <td>1.408335</td>\n","      <td>0.512346</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.917800</td>\n","      <td>1.413884</td>\n","      <td>0.522634</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.867000</td>\n","      <td>1.430292</td>\n","      <td>0.514403</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.820800</td>\n","      <td>1.426127</td>\n","      <td>0.520576</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=1080, training_loss=1.1798527329056352, metrics={'train_runtime': 591.0541, 'train_samples_per_second': 114.981, 'train_steps_per_second': 1.827, 'total_flos': 1987195340724720.0, 'train_loss': 1.1798527329056352, 'epoch': 20.0})"]},"metadata":{},"execution_count":35}]},{"cell_type":"code","source":["y_pred = taskC_trainer.predict(taskC_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskC_test['label_vector'], y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":141},"id":"TbtvL8X_UwDi","executionInfo":{"status":"ok","timestamp":1686379881977,"user_tz":420,"elapsed":2572,"user":{"displayName":"Ryan Chien","userId":"13383678788289139200"}},"outputId":"c3d379c4-d59d-44d7-bb0c-04ed5c027175"},"execution_count":42,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.51237\n","precision: 0.4961804433563484\n","recall: 0.5123711340206185\n","f1 score: 0.49350002118403713\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}]}]}