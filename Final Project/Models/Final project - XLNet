{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21764,"status":"ok","timestamp":1686899377200,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"sqnV1wnV_iHU","outputId":"268f68f7-0c9f-4583-b7d9-440afb7853ad"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n","/content/drive/Shareddrives/CS263\n"]}],"source":["import os\n","from google.colab import drive\n","drive.mount('/content/drive')\n","%cd /content/drive/Shareddrives/CS263"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":31156,"status":"ok","timestamp":1686899438993,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"O0hye2QojNR0","outputId":"b31ed507-9011-4b15-ca1b-eb6535f2a405"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.13.0-py3-none-any.whl (485 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m485.6/485.6 kB\u001b[0m \u001b[31m11.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting dill<0.3.7,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m15.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m26.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.14-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m19.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Collecting aiohttp (from datasets)\n","  Downloading aiohttp-3.8.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m42.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting huggingface-hub<1.0.0,>=0.11.0 (from datasets)\n","  Downloading huggingface_hub-0.15.1-py3-none-any.whl (236 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m236.8/236.8 kB\u001b[0m \u001b[31m30.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting multidict<7.0,>=4.5 (from aiohttp->datasets)\n","  Downloading multidict-6.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 kB\u001b[0m \u001b[31m6.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3 (from aiohttp->datasets)\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting yarl<2.0,>=1.0 (from aiohttp->datasets)\n","  Downloading yarl-1.9.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m14.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting frozenlist>=1.1.1 (from aiohttp->datasets)\n","  Downloading frozenlist-1.3.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m149.6/149.6 kB\u001b[0m \u001b[31m11.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiosignal>=1.1.2 (from aiohttp->datasets)\n","  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (3.12.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Installing collected packages: xxhash, multidict, frozenlist, dill, async-timeout, yarl, multiprocess, huggingface-hub, aiosignal, aiohttp, datasets\n","Successfully installed aiohttp-3.8.4 aiosignal-1.3.1 async-timeout-4.0.2 datasets-2.13.0 dill-0.3.6 frozenlist-1.3.3 huggingface-hub-0.15.1 multidict-6.0.4 multiprocess-0.70.14 xxhash-3.2.0 yarl-1.9.2\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers[torch]\n","  Downloading transformers-4.30.2-py3-none-any.whl (7.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m62.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (3.12.0)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.14.1 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (0.15.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers[torch])\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m119.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers[torch])\n","  Downloading safetensors-0.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m86.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (4.65.0)\n","Requirement already satisfied: torch!=1.12.0,>=1.9 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2.0.1+cu118)\n","Collecting accelerate>=0.20.2 (from transformers[torch])\n","  Downloading accelerate-0.20.3-py3-none-any.whl (227 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m227.6/227.6 kB\u001b[0m \u001b[31m17.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate>=0.20.2->transformers[torch]) (5.9.5)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers[torch]) (2023.4.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers[torch]) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch!=1.12.0,>=1.9->transformers[torch]) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch!=1.12.0,>=1.9->transformers[torch]) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch!=1.12.0,>=1.9->transformers[torch]) (16.0.5)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (3.4)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch!=1.12.0,>=1.9->transformers[torch]) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch!=1.12.0,>=1.9->transformers[torch]) (1.3.0)\n","Installing collected packages: tokenizers, safetensors, transformers, accelerate\n","Successfully installed accelerate-0.20.3 safetensors-0.3.1 tokenizers-0.13.3 transformers-4.30.2\n"]}],"source":["!pip install datasets\n","!pip install transformers[torch]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_AdDAamfAPhl"},"outputs":[],"source":["import csv\n","\n","label_dict = {'not sexist': 0, 'sexist': 1}\n","category_dict = {'1. threats, plans to harm and incitement': 0, '2. derogation': 1, '3. animosity': 2, '4. prejudiced discussions': 3, 'none': 4}\n","vector_dict = {\n","    '1.1 threats of harm': 0,\n","    '1.2 incitement and encouragement of harm': 1,\n","    '2.1 descriptive attacks': 2,\n","    '2.2 aggressive and emotive attacks': 3,\n","    '2.3 dehumanising attacks & overt sexual objectification': 4,\n","    '3.1 casual use of gendered slurs, profanities, and insults': 5,\n","    '3.2 immutable gender differences and gender stereotypes': 6,\n","    '3.3 backhanded gendered compliments': 7,\n","    '3.4 condescending explanations or unwelcome advice': 8,\n","    '4.1 supporting mistreatment of individual women': 9,\n","    '4.2 supporting systemic discrimination against women as a group': 10,\n","    'none': 0,\n","    }\n","\n","with open('edos_labelled_aggregated.csv') as file:\n","  data = list(csv.reader(file, quotechar='\"'))\n","  taskA_train = []\n","  taskA_dev = []\n","  taskA_test = []\n","  taskB_train = []\n","  taskB_dev = []\n","  taskB_test = []\n","  taskC_train = []\n","  taskC_dev = []\n","  taskC_test = []\n","  for i in range(len(data)):\n","    if i == 0:\n","      continue\n","\n","    temp_dict = {\n","        'rewire_id': data[i][0],\n","        'text': data[i][1],\n","        'label_sexist': label_dict[data[i][2]],\n","        'label_category': category_dict[data[i][3]],\n","        'label_vector': vector_dict[data[i][4]],\n","        'split': data[i][5]\n","        }\n","\n","    if temp_dict['split'] == 'train':\n","      taskA_train.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_train.append(temp_dict)\n","        taskC_train.append(temp_dict)\n","    elif temp_dict['split'] == 'dev':\n","      taskA_dev.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_dev.append(temp_dict)\n","        taskC_dev.append(temp_dict)\n","    else:\n","      taskA_test.append(temp_dict)\n","      if temp_dict['label_sexist'] == 1:\n","        taskB_test.append(temp_dict)\n","        taskC_test.append(temp_dict)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":413,"status":"ok","timestamp":1686899452156,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"4VzyUYtfA_6J","outputId":"0ae1b0e4-2425-48d2-f5de-292beae36a18"},"outputs":[{"name":"stdout","output_type":"stream","text":["14000 2000 4000\n"]}],"source":["print(len(taskA_train), len(taskA_dev), len(taskA_test))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1686899453565,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"Z17kv9oNFsbc","outputId":"6c6e7c63-4830-43c4-dec8-8fc3d9d0cfd0"},"outputs":[{"name":"stdout","output_type":"stream","text":["3398 486 970\n"]}],"source":["print(len(taskB_train), len(taskB_dev), len(taskB_test))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1686899455053,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"ynYNkDf4FtBr","outputId":"14fe974a-c177-4043-cad4-0e747702895e"},"outputs":[{"name":"stdout","output_type":"stream","text":["3398 486 970\n"]}],"source":["print(len(taskC_train), len(taskC_dev), len(taskC_test))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZkGRiN2ZEHDA"},"outputs":[],"source":["from sklearn.metrics import (accuracy_score,\n","                             auc,\n","                             confusion_matrix,\n","                              precision_score,\n","                              recall_score,\n","                              f1_score\n","                            )\n","\n","def get_acc(y_test, y_pred):\n","    acc = round(accuracy_score(y_test,y_pred), 5)\n","    precision = precision_score(y_test, y_pred, average='weighted')\n","    recall = recall_score(y_test, y_pred, average='weighted')\n","    f1score = f1_score(y_test, y_pred, average='weighted')\n","    print(f\"Accuracy: {acc}\")\n","    print(f\"precision: {precision}\")\n","    print(f\"recall: {recall}\")\n","    print(f\"f1 score: {f1score}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4oUQYPCmGFQT"},"outputs":[],"source":["from datasets import Dataset, load_metric\n","from sklearn.metrics import accuracy_score\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification, TrainingArguments, Trainer\n","import torch\n","import numpy as np\n","\n","taskA_train = Dataset.from_list(taskA_train)\n","taskA_dev = Dataset.from_list(taskA_dev)\n","taskA_test = Dataset.from_list(taskA_test)\n","taskB_train = Dataset.from_list(taskB_train)\n","taskB_dev = Dataset.from_list(taskB_dev)\n","taskB_test = Dataset.from_list(taskB_test)\n","taskC_train = Dataset.from_list(taskC_train)\n","taskC_dev = Dataset.from_list(taskC_dev)\n","taskC_test = Dataset.from_list(taskC_test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1686899476202,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"qgWr398OhP9C","outputId":"66d1d01b-3315-4ce1-d8e2-5171c6afa9d6"},"outputs":[{"data":{"text/plain":["Dataset({\n","    features: ['rewire_id', 'text', 'label_sexist', 'label_category', 'label_vector', 'split'],\n","    num_rows: 14000\n","})"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["taskA_train"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zYVulYdt6RvJ"},"outputs":[],"source":["class EDOS(torch.utils.data.Dataset):\n","  def __init__(self, encodings, labels):\n","    self.encodings = encodings\n","    self.labels = labels\n","\n","  def __getitem__(self, idx):\n","    item = {key: torch.tensor(val[idx]) for key, val in self.encodings.items()}\n","    item['labels'] = torch.tensor(self.labels[idx])\n","    return item\n","\n","  def __len__(self):\n","    return len(self.labels)\n","\n","def compute_metrics(eval_pred):\n","  preds, labels = eval_pred\n","  preds = np.argmax(preds, axis = 1)\n","  return metric.compute(predictions = preds, references = labels)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7196,"status":"ok","timestamp":1686899489254,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"kTS_MzjNyKlE","outputId":"6f2d5229-020b-4682-c678-3923e4bd68dc"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting sentencepiece\n","  Downloading sentencepiece-0.1.99-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m20.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: sentencepiece\n","Successfully installed sentencepiece-0.1.99\n"]}],"source":["!pip install sentencepiece"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":217,"referenced_widgets":["1959c018255b43ebb9cd25bee2d90887","d4ee3d8d4bc14898892e17eada1072a3","10ea89de42824c00b283aee6b3e8b6d6","6f719dab9ca7488495a212d34597a4b9","4a1e5fa707b2442aad5c3641865ff7eb","29c614b79f16481db883d9ff733691de","89cc6f99809345fd86fc4e10ef0fa744","4be576af299e463ab08cc82a85000062","33d3f06399ae4a7699e24d8401223933","88ca9e9755a64e1d9897c42b4bf7b118","2b026fa83917450a81c8dc950e6bf271","dd2e079dd5174f59b6f75f6c78153884","0bda7c348ece499eb0eaf0b25a3ce578","b8bcac13eb114ecc87d88f54a59055fd","9fc55ef10f8a4f57a48011768036e635","36f29c8e79a74f13913042d69ab56c66","d04bbf046d014c378d105b3d2567f7c3","b01672386fac4ff5a891aeeabff0025c","1eb820e6647448389677e2f6b1ded680","fdeabe654d4e405b942079fb8079947b","0437867ba63c4321987079ca6a3f0df8","9146e4e20c314d09903aed1742a2750f","579a7d5dee474500877bad27f445fd9c","073e278a12264f3b9113dbfbc6b17a3d","9ce47ed0c7b7431cb25bf5d9d49d14b9","bd3797eccb9345a884dfabbec2c094cb","e756b28b547c4508aa9501633fafe301","217a00d756224d1fb7b03fc94fc5004b","7ca245e884634a6bb9aff28e51f89b58","4f9a26f51869485cb66cdd1ead4d1070","7e6fcf5d595a4617b05843f28207076a","0f7cbffcd00049d98c02c8d182b7ff78","0894cdcad1144493a91dc467a2983b4b","53d0cfe3d6934779a97b62eae02037c2","9ef0b0967db547778e0b5adba57e874b","ffe0d9d0a41d456fbc90504fcfbf8d62","7776760c2d144f8b992a75a5c2441bfe","30403a9aee0d4058ab3ca15714ff3622","d11dde04017441b681f08fc70f6eb6ad","66ee2ba1f19344c0ad6d875ee8935c78","cc607cd655cb4a53bf640590b9c5b5be","9619a465312440059e5008a2fb99cd2b","d58dd7fd0b194ef698b79bee8f9cbd4a","7bb414f06a3c4124b191ad9a4b383635"]},"executionInfo":{"elapsed":9099,"status":"ok","timestamp":1686899500668,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"},"user_tz":420},"id":"1kTGdqOgkK6h","outputId":"9d5defbc-b932-4048-8530-dc377973be83"},"outputs":[{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1959c018255b43ebb9cd25bee2d90887","version_major":2,"version_minor":0},"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/760 [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"dd2e079dd5174f59b6f75f6c78153884","version_major":2,"version_minor":0},"text/plain":["Downloading (…)ve/main/spiece.model:   0%|          | 0.00/798k [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"579a7d5dee474500877bad27f445fd9c","version_major":2,"version_minor":0},"text/plain":["Downloading (…)/main/tokenizer.json:   0%|          | 0.00/1.38M [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"name":"stderr","output_type":"stream","text":["Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.\n","<ipython-input-12-c71cca176c66>:21: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate\n","  metric = load_metric('accuracy')\n"]},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"53d0cfe3d6934779a97b62eae02037c2","version_major":2,"version_minor":0},"text/plain":["Downloading builder script:   0%|          | 0.00/1.65k [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"}],"source":["model_path = 'xlnet-base-cased'\n","tokenizer = AutoTokenizer.from_pretrained(model_path)\n","taskA_train_encodings = tokenizer(taskA_train['text'], truncation = True, padding = True)\n","taskA_dev_encodings = tokenizer(taskA_dev['text'], truncation = True, padding = True)\n","taskA_test_encodings = tokenizer(taskA_test['text'], truncation = True, padding = True)\n","taskA_train_dataset = EDOS(taskA_train_encodings, taskA_train['label_sexist'])\n","taskA_dev_dataset = EDOS(taskA_dev_encodings, taskA_dev['label_sexist'])\n","taskA_test_dataset = EDOS(taskA_test_encodings, taskA_test['label_sexist'])\n","taskB_train_encodings = tokenizer(taskB_train['text'], truncation = True, padding = True)\n","taskB_dev_encodings = tokenizer(taskB_dev['text'], truncation = True, padding = True)\n","taskB_test_encodings = tokenizer(taskB_test['text'], truncation = True, padding = True)\n","taskB_train_dataset = EDOS(taskB_train_encodings, taskB_train['label_category'])\n","taskB_dev_dataset = EDOS(taskB_dev_encodings, taskB_dev['label_category'])\n","taskB_test_dataset = EDOS(taskB_test_encodings, taskB_test['label_category'])\n","taskC_train_encodings = tokenizer(taskC_train['text'], truncation = True, padding = True)\n","taskC_dev_encodings = tokenizer(taskC_dev['text'], truncation = True, padding = True)\n","taskC_test_encodings = tokenizer(taskC_test['text'], truncation = True, padding = True)\n","taskC_train_dataset = EDOS(taskC_train_encodings, taskC_train['label_vector'])\n","taskC_dev_dataset = EDOS(taskC_dev_encodings, taskC_dev['label_vector'])\n","taskC_test_dataset = EDOS(taskC_test_encodings, taskC_test['label_vector'])\n","metric = load_metric('accuracy')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IrddTUyqeMdr"},"outputs":[],"source":["batch_size = 64\n","epoch = 10\n","\n","taskA_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["790c5b1230f947a48a90cc5285ba5383","8a2da0b058f043e5a744cd059060af52","3e1cf3e176e345cfa947d0732621180d","eaf166f2308843148b546c0a8fe27594","2e96442f3cf44df3a1996a96718c6628","44bc78e816324f8db5ec2abc9480c309","c8fa0aabd5694102a029d5c124587966","1559a63c599f448ea318c0122cf16821","596c84b458d449e1baf9b129d6bab1f5","db262a1f2e3648299b739832546cbc0f","951cf7386877455bb4fb9945c5673b65"]},"id":"mEk8toEV7mIe","outputId":"8335dd0f-4025-407d-ccf1-1a917f20f2c0"},"outputs":[{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"790c5b1230f947a48a90cc5285ba5383","version_major":2,"version_minor":0},"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/467M [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"name":"stderr","output_type":"stream","text":["Some weights of the model checkpoint at xlnet-base-cased were not used when initializing XLNetForSequenceClassification: ['lm_loss.bias', 'lm_loss.weight']\n","- This IS expected if you are initializing XLNetForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing XLNetForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of XLNetForSequenceClassification were not initialized from the model checkpoint at xlnet-base-cased and are newly initialized: ['sequence_summary.summary.weight', 'logits_proj.weight', 'sequence_summary.summary.bias', 'logits_proj.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"data":{"text/html":["\n","    <div>\n","      \n","      <progress value='2190' max='2190' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [2190/2190 1:21:35, Epoch 10/10]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>0.538400</td>\n","      <td>0.457275</td>\n","      <td>0.779500</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>0.443600</td>\n","      <td>0.370279</td>\n","      <td>0.839500</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>0.370500</td>\n","      <td>0.346261</td>\n","      <td>0.844000</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>0.350300</td>\n","      <td>0.330419</td>\n","      <td>0.861000</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>0.312100</td>\n","      <td>0.337170</td>\n","      <td>0.851000</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>0.294300</td>\n","      <td>0.331612</td>\n","      <td>0.867500</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.284200</td>\n","      <td>0.361671</td>\n","      <td>0.862500</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.242900</td>\n","      <td>0.356064</td>\n","      <td>0.865500</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.248200</td>\n","      <td>0.361261</td>\n","      <td>0.868500</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.207900</td>\n","      <td>0.370401</td>\n","      <td>0.867500</td>\n","    </tr>\n","    <tr>\n","      <td>1100</td>\n","      <td>0.215500</td>\n","      <td>0.360971</td>\n","      <td>0.862500</td>\n","    </tr>\n","    <tr>\n","      <td>1200</td>\n","      <td>0.186700</td>\n","      <td>0.370706</td>\n","      <td>0.863500</td>\n","    </tr>\n","    <tr>\n","      <td>1300</td>\n","      <td>0.176400</td>\n","      <td>0.391290</td>\n","      <td>0.854500</td>\n","    </tr>\n","    <tr>\n","      <td>1400</td>\n","      <td>0.167100</td>\n","      <td>0.389182</td>\n","      <td>0.867500</td>\n","    </tr>\n","    <tr>\n","      <td>1500</td>\n","      <td>0.150900</td>\n","      <td>0.408658</td>\n","      <td>0.864000</td>\n","    </tr>\n","    <tr>\n","      <td>1600</td>\n","      <td>0.132700</td>\n","      <td>0.432115</td>\n","      <td>0.868000</td>\n","    </tr>\n","    <tr>\n","      <td>1700</td>\n","      <td>0.132000</td>\n","      <td>0.435393</td>\n","      <td>0.870500</td>\n","    </tr>\n","    <tr>\n","      <td>1800</td>\n","      <td>0.120600</td>\n","      <td>0.444284</td>\n","      <td>0.869500</td>\n","    </tr>\n","    <tr>\n","      <td>1900</td>\n","      <td>0.118400</td>\n","      <td>0.448026</td>\n","      <td>0.866500</td>\n","    </tr>\n","    <tr>\n","      <td>2000</td>\n","      <td>0.119800</td>\n","      <td>0.453594</td>\n","      <td>0.866500</td>\n","    </tr>\n","    <tr>\n","      <td>2100</td>\n","      <td>0.096600</td>\n","      <td>0.460446</td>\n","      <td>0.865500</td>\n","    </tr>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["TrainOutput(global_step=2190, training_loss=0.22892129889361934, metrics={'train_runtime': 4900.5235, 'train_samples_per_second': 28.568, 'train_steps_per_second': 0.447, 'total_flos': 1.082767625016e+16, 'train_loss': 0.22892129889361934, 'epoch': 10.0})"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["taskA_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 2)\n","\n","taskA_trainer = Trainer(\n","    model = taskA_model,\n","    args = taskA_training_args,\n","    train_dataset = taskA_train_dataset,\n","    eval_dataset = taskA_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskA_trainer.train()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"mdjmh0xxUNyf","outputId":"e157f69d-26c2-49da-921d-21dece0630de"},"outputs":[{"data":{"text/html":[],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["Accuracy: 0.87225\n","precision: 0.8697579726702309\n","recall: 0.87225\n","f1 score: 0.8707135238095238\n"]}],"source":["y_pred = taskA_trainer.predict(taskA_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskA_test['label_sexist'], y_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"MDQXHAiEI0So"},"outputs":[],"source":["epoch = 20\n","\n","taskB_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"5GDjuxJc7JgE","outputId":"fe0dc898-a203-4288-99d1-25efe876c66a"},"outputs":[{"name":"stderr","output_type":"stream","text":["Some weights of the model checkpoint at xlnet-base-cased were not used when initializing XLNetForSequenceClassification: ['lm_loss.bias', 'lm_loss.weight']\n","- This IS expected if you are initializing XLNetForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing XLNetForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of XLNetForSequenceClassification were not initialized from the model checkpoint at xlnet-base-cased and are newly initialized: ['sequence_summary.summary.weight', 'logits_proj.weight', 'sequence_summary.summary.bias', 'logits_proj.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"data":{"text/html":["\n","    <div>\n","      \n","      <progress value='1080' max='1080' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1080/1080 31:03, Epoch 20/20]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>1.159500</td>\n","      <td>1.040081</td>\n","      <td>0.483539</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>0.963000</td>\n","      <td>0.871287</td>\n","      <td>0.625514</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>0.811300</td>\n","      <td>0.870850</td>\n","      <td>0.629630</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>0.684900</td>\n","      <td>0.894450</td>\n","      <td>0.615226</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>0.562600</td>\n","      <td>0.938545</td>\n","      <td>0.619342</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>0.457200</td>\n","      <td>1.013120</td>\n","      <td>0.633745</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.383200</td>\n","      <td>1.080060</td>\n","      <td>0.619342</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.313400</td>\n","      <td>1.124848</td>\n","      <td>0.619342</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.261500</td>\n","      <td>1.164170</td>\n","      <td>0.592593</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.226300</td>\n","      <td>1.186644</td>\n","      <td>0.604938</td>\n","    </tr>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["TrainOutput(global_step=1080, training_loss=0.5552591147246184, metrics={'train_runtime': 1865.155, 'train_samples_per_second': 36.437, 'train_steps_per_second': 0.579, 'total_flos': 4613312024906880.0, 'train_loss': 0.5552591147246184, 'epoch': 20.0})"]},"execution_count":17,"metadata":{},"output_type":"execute_result"}],"source":["taskB_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 4)\n","\n","taskB_trainer = Trainer(\n","    model = taskB_model,\n","    args = taskB_training_args,\n","    train_dataset = taskB_train_dataset,\n","    eval_dataset = taskB_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskB_trainer.train()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"9N2hdhecUsAl","outputId":"a28706d5-2a38-45c7-dbca-9d19aaf49806"},"outputs":[{"data":{"text/html":[],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["Accuracy: 0.58144\n","precision: 0.5783208895824612\n","recall: 0.5814432989690722\n","f1 score: 0.5735374261612611\n"]}],"source":["y_pred = taskB_trainer.predict(taskB_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskB_test['label_category'], y_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"f8lxE34sJZMy"},"outputs":[],"source":["epoch = 20\n","\n","taskC_training_args = TrainingArguments(\n","    output_dir = './',\n","    learning_rate = 1e-5,\n","    num_train_epochs = epoch,\n","    per_device_train_batch_size = batch_size,\n","    per_device_eval_batch_size = batch_size,\n","    logging_steps = 100,\n","    evaluation_strategy = 'steps',\n","    eval_steps = 100,\n","    metric_for_best_model = 'eval_accuracy',\n","    load_best_model_at_end = True\n",")"]},{"cell_type":"code","execution_count":20,"metadata":{"id":"4F3kecvO7SsS","colab":{"base_uri":"https://localhost:8080/","height":624},"executionInfo":{"status":"ok","timestamp":1686908218738,"user_tz":420,"elapsed":1838880,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"}},"outputId":"acfc3a48-9b34-4c8e-b347-b00a9167f759"},"outputs":[{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["Some weights of the model checkpoint at xlnet-base-cased were not used when initializing XLNetForSequenceClassification: ['lm_loss.bias', 'lm_loss.weight']\n","- This IS expected if you are initializing XLNetForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing XLNetForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of XLNetForSequenceClassification were not initialized from the model checkpoint at xlnet-base-cased and are newly initialized: ['sequence_summary.summary.weight', 'logits_proj.weight', 'sequence_summary.summary.bias', 'logits_proj.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"data":{"text/html":["\n","    <div>\n","      \n","      <progress value='17' max='1080' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [  17/1080 00:25 < 30:17, 0.58 it/s, Epoch 0.30/20]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='1080' max='1080' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1080/1080 31:05, Epoch 20/20]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>100</td>\n","      <td>1.981700</td>\n","      <td>1.762930</td>\n","      <td>0.380658</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>1.605800</td>\n","      <td>1.571308</td>\n","      <td>0.467078</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>1.361800</td>\n","      <td>1.450827</td>\n","      <td>0.479424</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>1.194800</td>\n","      <td>1.424785</td>\n","      <td>0.497942</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>1.012900</td>\n","      <td>1.420914</td>\n","      <td>0.510288</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>0.885400</td>\n","      <td>1.441373</td>\n","      <td>0.518519</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>0.763100</td>\n","      <td>1.492323</td>\n","      <td>0.516461</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>0.681800</td>\n","      <td>1.508958</td>\n","      <td>0.524691</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>0.615700</td>\n","      <td>1.546075</td>\n","      <td>0.510288</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.556300</td>\n","      <td>1.555279</td>\n","      <td>0.518519</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=1080, training_loss=1.0266313800105342, metrics={'train_runtime': 1867.6403, 'train_samples_per_second': 36.388, 'train_steps_per_second': 0.578, 'total_flos': 4613579811500640.0, 'train_loss': 1.0266313800105342, 'epoch': 20.0})"]},"metadata":{},"execution_count":20}],"source":["taskC_model = AutoModelForSequenceClassification.from_pretrained(model_path, num_labels = 11)\n","\n","taskC_trainer = Trainer(\n","    model = taskC_model,\n","    args = taskC_training_args,\n","    train_dataset = taskC_train_dataset,\n","    eval_dataset = taskC_dev_dataset,\n","    compute_metrics = compute_metrics\n",")\n","\n","taskC_trainer.train()"]},{"cell_type":"code","execution_count":21,"metadata":{"id":"TbtvL8X_UwDi","colab":{"base_uri":"https://localhost:8080/","height":141},"executionInfo":{"status":"ok","timestamp":1686908225277,"user_tz":420,"elapsed":6541,"user":{"displayName":"YUN-PING YANG","userId":"14791864450053914601"}},"outputId":"1d0e0d7c-b0e6-4403-aed8-ebf35f96e82a"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.50928\n","precision: 0.5001083008503624\n","recall: 0.5092783505154639\n","f1 score: 0.4994386799564358\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}],"source":["y_pred = taskC_trainer.predict(taskC_test_dataset).predictions.argmax(axis = 1)\n","\n","get_acc(taskC_test['label_vector'], y_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aavgAB8fDfTl"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"0437867ba63c4321987079ca6a3f0df8":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"073e278a12264f3b9113dbfbc6b17a3d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_217a00d756224d1fb7b03fc94fc5004b","placeholder":"​","style":"IPY_MODEL_7ca245e884634a6bb9aff28e51f89b58","value":"Downloading (…)/main/tokenizer.json: 100%"}},"0894cdcad1144493a91dc467a2983b4b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0bda7c348ece499eb0eaf0b25a3ce578":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d04bbf046d014c378d105b3d2567f7c3","placeholder":"​","style":"IPY_MODEL_b01672386fac4ff5a891aeeabff0025c","value":"Downloading (…)ve/main/spiece.model: 100%"}},"0f7cbffcd00049d98c02c8d182b7ff78":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10ea89de42824c00b283aee6b3e8b6d6":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4be576af299e463ab08cc82a85000062","max":760,"min":0,"orientation":"horizontal","style":"IPY_MODEL_33d3f06399ae4a7699e24d8401223933","value":760}},"1559a63c599f448ea318c0122cf16821":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1959c018255b43ebb9cd25bee2d90887":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d4ee3d8d4bc14898892e17eada1072a3","IPY_MODEL_10ea89de42824c00b283aee6b3e8b6d6","IPY_MODEL_6f719dab9ca7488495a212d34597a4b9"],"layout":"IPY_MODEL_4a1e5fa707b2442aad5c3641865ff7eb"}},"1eb820e6647448389677e2f6b1ded680":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"217a00d756224d1fb7b03fc94fc5004b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"29c614b79f16481db883d9ff733691de":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2b026fa83917450a81c8dc950e6bf271":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2e96442f3cf44df3a1996a96718c6628":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"30403a9aee0d4058ab3ca15714ff3622":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"33d3f06399ae4a7699e24d8401223933":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"36f29c8e79a74f13913042d69ab56c66":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e1cf3e176e345cfa947d0732621180d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1559a63c599f448ea318c0122cf16821","max":467042463,"min":0,"orientation":"horizontal","style":"IPY_MODEL_596c84b458d449e1baf9b129d6bab1f5","value":467042463}},"44bc78e816324f8db5ec2abc9480c309":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4a1e5fa707b2442aad5c3641865ff7eb":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4be576af299e463ab08cc82a85000062":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f9a26f51869485cb66cdd1ead4d1070":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"53d0cfe3d6934779a97b62eae02037c2":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9ef0b0967db547778e0b5adba57e874b","IPY_MODEL_ffe0d9d0a41d456fbc90504fcfbf8d62","IPY_MODEL_7776760c2d144f8b992a75a5c2441bfe"],"layout":"IPY_MODEL_30403a9aee0d4058ab3ca15714ff3622"}},"579a7d5dee474500877bad27f445fd9c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_073e278a12264f3b9113dbfbc6b17a3d","IPY_MODEL_9ce47ed0c7b7431cb25bf5d9d49d14b9","IPY_MODEL_bd3797eccb9345a884dfabbec2c094cb"],"layout":"IPY_MODEL_e756b28b547c4508aa9501633fafe301"}},"596c84b458d449e1baf9b129d6bab1f5":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"66ee2ba1f19344c0ad6d875ee8935c78":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6f719dab9ca7488495a212d34597a4b9":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_88ca9e9755a64e1d9897c42b4bf7b118","placeholder":"​","style":"IPY_MODEL_2b026fa83917450a81c8dc950e6bf271","value":" 760/760 [00:00&lt;00:00, 19.5kB/s]"}},"7776760c2d144f8b992a75a5c2441bfe":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d58dd7fd0b194ef698b79bee8f9cbd4a","placeholder":"​","style":"IPY_MODEL_7bb414f06a3c4124b191ad9a4b383635","value":" 4.21k/? [00:00&lt;00:00, 88.6kB/s]"}},"790c5b1230f947a48a90cc5285ba5383":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8a2da0b058f043e5a744cd059060af52","IPY_MODEL_3e1cf3e176e345cfa947d0732621180d","IPY_MODEL_eaf166f2308843148b546c0a8fe27594"],"layout":"IPY_MODEL_2e96442f3cf44df3a1996a96718c6628"}},"7bb414f06a3c4124b191ad9a4b383635":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7ca245e884634a6bb9aff28e51f89b58":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7e6fcf5d595a4617b05843f28207076a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"88ca9e9755a64e1d9897c42b4bf7b118":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"89cc6f99809345fd86fc4e10ef0fa744":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8a2da0b058f043e5a744cd059060af52":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_44bc78e816324f8db5ec2abc9480c309","placeholder":"​","style":"IPY_MODEL_c8fa0aabd5694102a029d5c124587966","value":"Downloading pytorch_model.bin: 100%"}},"9146e4e20c314d09903aed1742a2750f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"951cf7386877455bb4fb9945c5673b65":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9619a465312440059e5008a2fb99cd2b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9ce47ed0c7b7431cb25bf5d9d49d14b9":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4f9a26f51869485cb66cdd1ead4d1070","max":1382015,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7e6fcf5d595a4617b05843f28207076a","value":1382015}},"9ef0b0967db547778e0b5adba57e874b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d11dde04017441b681f08fc70f6eb6ad","placeholder":"​","style":"IPY_MODEL_66ee2ba1f19344c0ad6d875ee8935c78","value":"Downloading builder script: "}},"9fc55ef10f8a4f57a48011768036e635":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0437867ba63c4321987079ca6a3f0df8","placeholder":"​","style":"IPY_MODEL_9146e4e20c314d09903aed1742a2750f","value":" 798k/798k [00:00&lt;00:00, 7.36MB/s]"}},"b01672386fac4ff5a891aeeabff0025c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b8bcac13eb114ecc87d88f54a59055fd":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1eb820e6647448389677e2f6b1ded680","max":798011,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fdeabe654d4e405b942079fb8079947b","value":798011}},"bd3797eccb9345a884dfabbec2c094cb":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0f7cbffcd00049d98c02c8d182b7ff78","placeholder":"​","style":"IPY_MODEL_0894cdcad1144493a91dc467a2983b4b","value":" 1.38M/1.38M [00:00&lt;00:00, 12.7MB/s]"}},"c8fa0aabd5694102a029d5c124587966":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cc607cd655cb4a53bf640590b9c5b5be":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d04bbf046d014c378d105b3d2567f7c3":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d11dde04017441b681f08fc70f6eb6ad":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d4ee3d8d4bc14898892e17eada1072a3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_29c614b79f16481db883d9ff733691de","placeholder":"​","style":"IPY_MODEL_89cc6f99809345fd86fc4e10ef0fa744","value":"Downloading (…)lve/main/config.json: 100%"}},"d58dd7fd0b194ef698b79bee8f9cbd4a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db262a1f2e3648299b739832546cbc0f":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dd2e079dd5174f59b6f75f6c78153884":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0bda7c348ece499eb0eaf0b25a3ce578","IPY_MODEL_b8bcac13eb114ecc87d88f54a59055fd","IPY_MODEL_9fc55ef10f8a4f57a48011768036e635"],"layout":"IPY_MODEL_36f29c8e79a74f13913042d69ab56c66"}},"e756b28b547c4508aa9501633fafe301":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eaf166f2308843148b546c0a8fe27594":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_db262a1f2e3648299b739832546cbc0f","placeholder":"​","style":"IPY_MODEL_951cf7386877455bb4fb9945c5673b65","value":" 467M/467M [00:05&lt;00:00, 89.8MB/s]"}},"fdeabe654d4e405b942079fb8079947b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ffe0d9d0a41d456fbc90504fcfbf8d62":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_cc607cd655cb4a53bf640590b9c5b5be","max":1652,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9619a465312440059e5008a2fb99cd2b","value":1652}}}}},"nbformat":4,"nbformat_minor":0}